import{r as Y,y as H,o as a,c as I,w as E,a as f,Q as R,G as w,z as e,Y as l,ab as y,az as T,a1 as O,F as x}from"./index.02f7c95d.js";import P from"./ATitleBar.bbf1d9a4.js";import{api as B}from"./axios.816e1a60.js";import{g as G}from"./header.10137493.js";import{u as j}from"./codeStore.e69f9e04.js";import{u as Q}from"./counselTypeStore.5faa86f9.js";import{h as K}from"./errorHandler.5efe1eb1.js";import{_ as q}from"./_plugin-vue_export-helper.cdc0426e.js";import"./ClosePopup.daa62b28.js";import"./dialog.88ce899f.js";import"./CommonPopup.2b0ee10b.js";import"./use-dialog-plugin-component.234e0905.js";import"./authStore.fadf8446.js";import"./counsel-hub.145170b4.js";const z=c=>B.get("/rest/api/v1/ticket/histories",{headers:G("yyyy-MM-dd HH:mm:ss").headers,params:c}),F={getTicketHistory:z};const J={class:"fit total"},$={key:0},V=["innerHTML"],W={class:"a-table full-width"},X={key:1},Z="\uC791\uC5C5\uC774\uB825",tt={__name:"TicketHistory",props:["ticketEntityId"],setup(c){const C=c,D=j(),S=Q(),u=Y([]),_={TYPE:"\uD2F0\uCF13\uC720\uD615",STATUS:"\uCC98\uB9AC\uC0C1\uD0DC",PRODUCT_TYPE:"\uC81C\uD488\uBD84\uB958",COUNSEL_CATEGORY_CODE:"\uC0C1\uB2F4\uAD6C\uBD84",COUNSEL_TYPE_CODE_LARGE:"\uC0C1\uB2F4\uC720\uD615(\uB300)",COUNSEL_TYPE_CODE_MEDIUM:"\uC0C1\uB2F4\uC720\uD615(\uC911)",COUNSEL_TYPE_CODE_SMALL:"\uC0C1\uB2F4\uC720\uD615(\uC18C)",INQUIRY:"\uBB38\uC758",CONTENTS:"\uC0C1\uB2F4\uB0B4\uC6A9",CALLBACK_RESERVATION_DATE:"\uC7AC\uD1B5\uD654\uC608\uC57D",MANAGER_EID:"\uB2F4\uB2F9\uC790",CUSTOMER_NAME:"\uACE0\uAC1D\uBA85",TEL:"\uC804\uD654\uBC88\uD638"};H(()=>{g()});function g(){const s={};s["entity.ticketEntityId"]=C.ticketEntityId,F.getTicketHistory(s).then(t=>{t.status===200&&(u.value=k(t.data),console.log(u.value))}).catch(t=>{K(t)})}function k(s){const t=s.reduce((r,n)=>{const i=n.createdDate;r[i]||(r[i]={});const o=n.lastModifiedBy;return r[i][o]||(r[i][o]=[]),r[i][o].push(n),r},{});return Object.entries(t).sort(([r],[n])=>new Date(n)-new Date(r)).reduce((r,[n,i])=>(r[n]=Object.entries(i).sort(([o],[p])=>p-o).reduce((o,[p,h])=>{const A=h.sort((M,U)=>{const b=Object.keys(_).indexOf(M.typeCode),v=Object.keys(_).indexOf(U.typeCode);return b-v});return o[p]=A,o},{}),r),{})}function L(s){return JSON.parse(s).contents}function N(s){return _[s]||"\uAE30\uD0C0"}function m(s,t){var d,r;return s==="TYPE"||s==="STATUS"||s==="COUNSEL_CATEGORY_CODE"?((d=D.codes.get(t))==null?void 0:d.name)||t:(s==="COUNSEL_TYPE_CODE_LARGE"||s==="COUNSEL_TYPE_CODE_MEDIUM"||s==="COUNSEL_TYPE_CODE_SMALL")&&((r=S.counselTypes.get(t))==null?void 0:r.name)||t}return(s,t)=>(a(),I(x,{ref:"dialogRef","no-backdrop-dismiss":"","transition-show":"fade","transition-hide":"fade"},{default:E(()=>[f(R,{class:"dialog-large"},{default:E(()=>[f(P,{title:Z,close:!0}),f(w,{class:"q-pa-xs"},{default:E(()=>[e("div",J,[Object.keys(u.value).length?(a(),l("div",$,[(a(!0),l(y,null,T(u.value,(d,r)=>(a(),l("div",{key:r,class:"fit q-mt-xs"},[(a(!0),l(y,null,T(d,(n,i)=>(a(),l("div",{key:i,class:"fit"},[e("span",{innerHTML:L(n[0].details)},null,8,V),e("table",W,[t[0]||(t[0]=e("colgroup",null,[e("col",{width:"20%"}),e("col",{width:"40%"}),e("col",{width:"40%"})],-1)),t[1]||(t[1]=e("thead",null,[e("tr",null,[e("td",null,"\uD56D\uBAA9\uBA85"),e("td",null,"\uC6D0\uB798 \uAC12"),e("td",null,"\uC0C8 \uAC12")])],-1)),e("tbody",null,[(a(!0),l(y,null,T(n,o=>(a(),l("tr",{key:o.entityId},[e("td",null,O(N(o.typeCode)),1),e("td",null,O(m(o.typeCode,o.previousData)||"-"),1),e("td",null,O(m(o.typeCode,o.newData)||"-"),1)]))),128))])])]))),128))]))),128))])):(a(),l("div",X,t[2]||(t[2]=[e("span",null,"\uC791\uC5C5 \uB0B4\uC5ED\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.",-1)])))])]),_:1})]),_:1})]),_:1},512))}},ft=q(tt,[["__scopeId","data-v-017bedef"]]);export{ft as default};
