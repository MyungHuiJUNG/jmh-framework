import{Q as y}from"./QBadge.c1f4e948.js";import{r as s,g as N,y as L,o as T,c as H,w as u,F as K,a as l,z as o,a0 as n,a1 as G,Q as J}from"./index.02f7c95d.js";import{u as W,c as X}from"./BoardCatagoryManagePopup.4c280645.js";import{u as C}from"./use-dialog-plugin-component.234e0905.js";import{u as Y}from"./use-quasar.2d4ce40a.js";import{s as p,a as Z}from"./dialog.88ce899f.js";import ee from"./ATextEditor.d38287bf.js";import{b as te}from"./BoardCategory.e55ffcf3.js";import{F as oe,f as le}from"./FileUploadManage.e1cb862f.js";import se from"./ATitleBar.bbf1d9a4.js";import ae from"./AInput.398f059b.js";import I from"./ABtn.e24d7e8a.js";import{u as re}from"./utils.32a0767f.js";import ne from"./BoardCategoryRegist.79478ab1.js";import{h}from"./errorHandler.5efe1eb1.js";import{_ as ie}from"./_plugin-vue_export-helper.cdc0426e.js";import"./TabulatorGrid.9c80b09d.js";import"./axios.816e1a60.js";import"./header.10137493.js";import"./BoardCategoryMovePopup.1a199b96.js";import"./CommonPopup.2b0ee10b.js";import"./QTree.ce7bbb93.js";import"./QSlideTransition.b1b1fe3f.js";import"./QTooltip.86ca1c0e.js";import"./position-engine.53490cc8.js";import"./app-util.f29d8347.js";import"./permissionStore.29c18612.js";import"./permissionApi.ffe0b82d.js";import"./FlowRoleCode.12cdb02e.js";import"./ClosePopup.daa62b28.js";/* empty css                                                             */import"./authStore.fadf8446.js";import"./counsel-hub.145170b4.js";const ue={class:"col column full-width q-pa-xs"},ce={class:"col-auto row full-width fixed-height"},de={class:"col-auto t-column text-left top-border-left q-px-xs column justify-center"},me={class:"row"},pe={class:"col top-border-right justify-center column q-px-xs"},fe={class:"col-auto row fixed-height full-width"},ge={class:"col-auto t-column text-left body-border-left q-px-xs column justify-center"},ve={class:"row"},_e={class:"col body-border-left justify-center text-center column"},ye={class:"row justify-between items-center"},he={class:"q-ml-xs"},xe={class:"col row full-width"},we={class:"col-auto t-column text-left body-border-left q-px-xs column justify-center full-height"},be={class:"row"},Fe={class:"col body-border-right q-pa-xs no-wrap text-no-wrap full-height"},qe={class:"col-auto row full-width"},Ce={class:"col body-border-right justify-center column q-pa-xs"},Ie={class:"col-2 row"},Re={class:"col body-border-right justify-center no-wrap text-no-wrap overflow-auto full-height"},ke={class:"col-auto full-width text-right bg-grey-5 a-border q-pa-xs no-wrap"},je={__name:"BoardRegistPopup",props:{propCategoryData:Object},emits:[...C.emits],setup(R,{emit:De}){const{dialogRef:k,onDialogOK:j,onDialogHide:Be}=C(),D=Y(),B=W(),f=R,x=s(""),c=s(""),S=s(),d=s(),z=N(()=>re.removeHtmlTagsIncludingImg(d.value)),m=s(""),g=s(""),a=s([]),i=s([]),v=new Map,_=s(!1);function w(t){X.getCategory(t).then(e=>{const $=e.data.path.split(".").map(F=>{const q=B.categories.get(F);return q?q.name:F});g.value=$.join(" > ")}).catch(e=>{h(e)})}function E(){D.dialog({component:ne}).onOk(t=>{m.value=t,w(t)})}function A(){if(!c.value){p("\uC81C\uBAA9\uC744 \uC785\uB825\uD558\uC138\uC694.");return}if(!g.value){p("\uCE74\uD14C\uACE0\uB9AC\uB97C \uC120\uD0DD\uD558\uC138\uC694.");return}if(!d.value){p("\uB0B4\uC6A9\uC744 \uC785\uB825\uD558\uC138\uC694");return}const t={title:c.value,content:encodeURIComponent(d.value),rawContent:encodeURIComponent(z.value),readCount:0,categoryId:m.value};te.addBoard(t).then(e=>{e.status===200&&(M(e.data.entityId),p("\uB4F1\uB85D\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),j())}).catch(e=>{h(e)})}function b(){v.clear(),a.value=a.value.filter(t=>{const e=`${t.name}-${t.size}`;return v.has(e)?!1:(v.set(e,t),!0)}),i.value=[],i.value=a.value}function M(t){var e;(e=i.value)!=null&&e.length&&le.uploadFile("board",t,P()).then(r=>{console.log("\uD30C\uC77C\uC5C5\uB85C\uB4DC",r)}).catch(r=>{h(r)})}function O(t){const e=t.target.files;a.value.push(...e),b(),i.value=a.value,x.value.value=null}function P(){const t=new FormData;return i.value.forEach(e=>{t.append("file",e)}),t}function Q(t){Z("\uD574\uB2F9 \uD30C\uC77C\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?").then(e=>{e&&(a.value.splice(t,1),b())})}const V=()=>{const t=document.querySelector(".dialog-large");_.value?(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),_.value=!1):(t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),_.value=!0)};L(()=>{f.propCategoryData&&f.propCategoryData.categoryId&&(m.value=f.propCategoryData.categoryId,w(m.value))});function U(t){d.value=t}return(t,e)=>(T(),H(K,{ref_key:"dialogRef",ref:k,"no-backdrop-dismiss":"","transition-show":"fade","transition-hide":"fade",class:"column no-wrap","allow-focus-outside":""},{default:u(()=>[l(J,{class:"dialog-large column no-wrap fit"},{default:u(()=>[l(se,{title:"\uAC8C\uC2DC\uAE00\uB4F1\uB85D",maximize:!0,close:!0,class:"col-auto full-width",onMaximize:V}),o("div",ue,[o("div",ce,[o("div",de,[o("div",me,[l(y,{class:"q-pa-none q-mr-xs",color:"grey-2","text-color":"red"},{default:u(()=>e[1]||(e[1]=[n("*")])),_:1}),e[2]||(e[2]=n("\uC81C\uBAA9"))])]),o("div",pe,[l(ae,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=r=>c.value=r)},null,8,["modelValue"])])]),o("div",fe,[o("div",ge,[o("div",ve,[l(y,{class:"q-pa-none q-mr-xs",color:"grey-2","text-color":"red"},{default:u(()=>e[3]||(e[3]=[n("*")])),_:1}),e[4]||(e[4]=n("\uCE74\uD14C\uACE0\uB9AC "))])]),o("div",_e,[o("div",ye,[o("span",he,G(g.value),1),l(I,{label:"\uC120\uD0DD",class:"q-mx-xs",onClick:E})])])]),o("div",xe,[o("div",we,[o("div",be,[l(y,{class:"q-pa-none q-mr-xs",color:"grey-2","text-color":"red"},{default:u(()=>e[5]||(e[5]=[n("*")])),_:1}),e[6]||(e[6]=n("\uB0B4\uC6A9"))])]),o("div",Fe,[l(ee,{class:"fit column no-wrap","content-input":S.value,onContentOutput:U},null,8,["content-input"])])]),o("div",qe,[e[7]||(e[7]=o("div",{class:"col-auto t-column text-left body-border-left q-px-xs column justify-center"},"\uCCA8\uBD80\uD30C\uC77C",-1)),o("div",Ce,[o("input",{type:"file",onChange:O,multiple:"",ref_key:"fileInput",ref:x},null,544)])]),o("div",Ie,[e[8]||(e[8]=o("div",{class:"col-auto t-column text-left body-border-left q-px-xs column justify-center full-height"}," \uD30C\uC77C\uBAA9\uB85D ",-1)),o("div",Re,[l(oe,{tempLocalFiles:a.value,onRemoveFile:Q},null,8,["tempLocalFiles"])])]),o("div",ke,[l(I,{label:"\uC800\uC7A5",class:"q-ml-xs",onClick:A})])])]),_:1})]),_:1},512))}},dt=ie(je,[["__scopeId","data-v-ab38b7b8"]]);export{dt as default};
