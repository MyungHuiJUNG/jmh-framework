import{r as l,g as ue,t as _,y as de,o as D,c as I,w as j,F as ce,a as n,z as o,B as M,G as me,Q as fe}from"./index.02f7c95d.js";import O from"./AInput.398f059b.js";import q from"./ABtn.e24d7e8a.js";import L from"./TabulatorGrid.9c80b09d.js";import ge from"./ATitleBar.bbf1d9a4.js";import k from"./ACheckbox.923db872.js";import E from"./ASelect.a02a29e0.js";import{u as G}from"./use-dialog-plugin-component.234e0905.js";import{u as ve}from"./organizationStore.a86bd6ff.js";import{h as H}from"./errorHandler.5efe1eb1.js";import{u as P}from"./userApi.abe7b8c8.js";import pe from"./ALoadingSpinner.ca275fb8.js";import{_ as he}from"./_plugin-vue_export-helper.cdc0426e.js";/* empty css                                                             */import"./ClosePopup.daa62b28.js";import"./QItem.1bce08e7.js";import"./QSelect.b17c746f.js";import"./QMenu.3c9cf304.js";import"./position-engine.53490cc8.js";import"./rtl.276c3f1b.js";import"./format.2cae61da.js";import"./axios.816e1a60.js";import"./header.10137493.js";import"./dialog.88ce899f.js";import"./CommonPopup.2b0ee10b.js";import"./authStore.fadf8446.js";import"./counsel-hub.145170b4.js";const ze={class:"q-pa-xs"},we={class:"my-table a-border full-width"},be={class:"a-border"},Ve={class:"a-border"},Ae={class:"row"},ye={class:"a-border"},Se={class:"row"},_e={class:"row full-width no-wrap"},Re={class:"a-border"},xe={class:"row"},Ue={class:"a-border"},Ne={class:"row"},Ce={class:"row q-gutter-xs justify-end"},ke={class:"row q-pa-xs justify-end"},J="/rest/api/v1/user/users",He={__name:"UserPopup",props:{selectableRows:{type:[Boolean,Number],default:1},selectableRowsRangeMode:{type:[Boolean,String],default:!1},enableRowDblClick:{type:Boolean,default:!1},title:{type:String,default:"\uC0AC\uC6A9\uC790 \uC120\uD0DD"}},emits:[...G.emits],setup(g,{emit:Pe}){const W=g,s=ve(),R=l(!1),x=l(null),v=l(""),p=l(""),h=l(""),K=l(ue(()=>[{name:"\uC804\uCCB4",value:null},...s.organizationArray.map(a=>({name:a.name,value:a}))])),B=l([{name:"\uC804\uCCB4",value:null}]),U=l([{name:"\uC804\uCCB4",value:null}]),d=l(null),c=l(null),u=l(null),z=l(!1),w=l(!1),b=l(!1),V=l(!1),{dialogRef:X,onDialogOK:$}=G(),Y=[{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerHozAlign:"center",headerSort:!1,width:20},{title:"#",field:"rownum",formatter:"rownum",headerHozAlign:"center",hozAlign:"center",headerSort:!1,resizable:!1,width:50},{title:"\uC870\uC9C1(\uB300)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!1,formatter:function(a){const e=a.getValue();return e&&e.path&&e.path.split(".")[0]?s.organizations.get(e.path.split(".")[0]||"").name:""}},{title:"\uC870\uC9C1(\uC911)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!1,formatter:function(a){const e=a.getValue();return e&&e.path&&e.path.split(".")[1]?s.organizations.get(e.path.split(".")[1]||"").name:""}},{title:"\uC870\uC9C1(\uC18C)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!1,formatter:function(a){const e=a.getValue();return e&&e.path&&e.path.split(".")[2]?s.organizations.get(e.path.split(".")[2]||"").name:""}},{title:"\uC0AC\uC6A9\uC790\uBA85",field:"name",hozAlign:"center",headerHozAlign:"center",headerSort:!1},{title:"\uC544\uC774\uB514",field:"id",hozAlign:"center",headerHozAlign:"center",headerSort:!1},{title:"\uB0B4\uC120\uBC88\uD638",field:"ctiExtension",hozAlign:"center",headerHozAlign:"center",headerSort:!1}],Z=[{title:"#",field:"rownum",formatter:"rownum",headerHozAlign:"center",hozAlign:"center",headerSort:!1,resizable:!1,width:50},{title:"\uC870\uC9C1(\uB300)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!1,formatter:function(a){const e=a.getValue();return e&&e.path&&e.path.split(".")[0]?s.organizations.get(e.path.split(".")[0]||"").name:""}},{title:"\uC870\uC9C1(\uC911)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!1,formatter:function(a){const e=a.getValue();return e&&e.path&&e.path.split(".")[1]?s.organizations.get(e.path.split(".")[1]||"").name:""}},{title:"\uC870\uC9C1(\uC18C)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!1,formatter:function(a){const e=a.getValue();return e&&e.path&&e.path.split(".")[2]?s.organizations.get(e.path.split(".")[2]||"").name:""}},{title:"\uC0AC\uC6A9\uC790\uBA85",field:"name",hozAlign:"center",headerHozAlign:"center",headerSort:!1},{title:"\uC544\uC774\uB514",field:"id",hozAlign:"center",headerHozAlign:"center",headerSort:!1},{title:"\uB0B4\uC120\uBC88\uD638",field:"ctiExtension",hozAlign:"center",headerHozAlign:"center",headerSort:!1}],ee=l([]);function Q(a){ee.value=a}_(K,a=>{a.length&&(d.value=null)},{immediate:!0}),_(d,a=>{a?(w.value=!0,B.value=[{name:"\uC804\uCCB4",value:null},...s.getChildrenOrganizationsByTopParentCodeValue(a.code).map(e=>({name:e.name,value:e}))],c.value=null,u.value=null):(w.value=!1,B.value=[{name:"\uC804\uCCB4",value:null}],U.value=[{name:"\uC804\uCCB4",value:null}],c.value=null,u.value=null)},{immediate:!0}),_(c,a=>{a?(U.value=[{name:"\uC804\uCCB4",value:null},...s.getChildrenOrganizationsByTopParentCodeValue(a.code).map(e=>({name:e.name,value:e}))],u.value=null):(U.value=[{name:"\uC804\uCCB4",value:null}],u.value=null)},{immediate:!0});function N(){const a={};w.value&&(d.value&&(a.organizationPath=d.value.code),c.value&&(a.organizationPath+=`.${c.value.code}`),u.value&&(a.organizationPath+=`.${u.value.code}`)),z.value&&v.value.trim()&&(a["entity.name"]=v.value.trim()),b.value&&p.value.trim()&&(a["entity.id"]=p.value.trim()),V.value&&h.value.trim()&&(a["entity.ctiExtension"]=h.value.trim()),le(a)}function ae(){const a=x.value.getSelectedData();if(Array.isArray(a)&&a.length>0){const e=a.map(t=>({entityId:t.entityId,name:t.name,id:t.id}));$({payload:e})}}function te(a){const e=[{entityId:a.entityId,name:a.name,id:a.id}];$({payload:e})}const A=l([]),r=l(0),y=l(100),C=l(!1),S=l(!1),i=l({page:r.value,size:y.value});async function F(){if(!R.value&&!C.value){i.value={...i.value,page:r.value};try{const a=await P.getUsers(i.value);a.status===200&&(A.value=[...A.value,...a.data.content],C.value=a.data.last,r.value+=1)}catch(a){H(a)}}}function le(a){if(R.value)i.value={...a},ie();else return r.value=0,i.value={page:r.value,size:y.value,...a},S.value=!0,P.getUsers(i.value).then(e=>{e&&e.data&&(A.value=e.data.content,C.value=e.data.last,r.value+=1)}).catch(e=>{H(e)}).finally(()=>{S.value=!1})}function oe(){R.value?i.value={}:(r.value=0,i.value={page:r.value,size:y.value},S.value=!0,P.getUsers(i.value).then(a=>{a.status===200&&(A.value=a.data.content,C.value=a.data.last,r.value+=1)}).catch(a=>{H(a)}).finally(()=>{S.value=!1}))}_(v,a=>{a?z.value=!0:z.value=!1}),_(p,a=>{a?b.value=!0:b.value=!1}),_(h,a=>{a?V.value=!0:V.value=!1});function ne(){v.value="",p.value="",h.value="",d.value=null,z.value=!1,b.value=!1,w.value=!1,V.value=!1}de(()=>{setTimeout(()=>{oe()},100)});function ie(){x.value.setData()}function T(a,e,t){return i.value={...i.value,page:t.page-1,size:t.size||y.value,isPaging:!0},new Promise(function(m,se){P.getUsers(i.value).then(f=>{if(f.status===200){const re={data:f.data.content,last_page:f.data.totalPages,last_row:f.data.totalElements};m(re)}}).catch(f=>{H(f),se(f)})})}return(a,e)=>(D(),I(ce,{ref_key:"dialogRef",ref:X,"no-backdrop-dismiss":"","transition-show":"fade","transition-hide":"fade"},{default:j(()=>[n(fe,{class:"dialog-large"},{default:j(()=>[n(ge,{title:g.title,close:!0},null,8,["title"]),o("div",ze,[o("table",we,[o("tbody",null,[o("tr",be,[o("td",Ve,[o("div",Ae,[n(k,{modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=t=>z.value=t),label:"\uC0AC\uC6A9\uC790\uBA85"},null,8,["modelValue"])])]),o("td",null,[n(O,{class:"custom-input",modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),onKeyup:M(N,["enter"])},null,8,["modelValue"])]),o("td",ye,[o("div",Se,[n(k,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=t=>w.value=t),label:"\uC870\uC9C1"},null,8,["modelValue"])])]),o("td",null,[o("div",_e,[n(E,{class:"select-width text-no-wrap",modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=t=>d.value=t),options:K.value,"option-label":"name"},null,8,["modelValue","options"]),n(E,{class:"select-width text-no-wrap",modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=t=>c.value=t),options:B.value,"option-label":"name"},null,8,["modelValue","options"]),n(E,{class:"select-width text-no-wrap",modelValue:u.value,"onUpdate:modelValue":e[5]||(e[5]=t=>u.value=t),options:U.value,"option-label":"name"},null,8,["modelValue","options"])])])]),o("tr",null,[o("td",Re,[o("div",xe,[n(k,{modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=t=>b.value=t),label:"\uC544\uC774\uB514"},null,8,["modelValue"])])]),o("td",null,[n(O,{class:"custom-input",modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=t=>p.value=t),onKeyup:M(N,["enter"])},null,8,["modelValue"])]),o("td",Ue,[o("div",Ne,[n(k,{modelValue:V.value,"onUpdate:modelValue":e[8]||(e[8]=t=>V.value=t),label:"\uB0B4\uC120\uBC88\uD638"},null,8,["modelValue"])])]),o("td",null,[n(O,{class:"custom-input",modelValue:h.value,"onUpdate:modelValue":e[9]||(e[9]=t=>h.value=t),onKeyup:M(N,["enter"])},null,8,["modelValue"])]),o("td",null,[o("div",Ce,[n(q,{label:"\uC870\uD68C",onClick:N}),n(q,{label:"\uCD08\uAE30\uD654",onClick:ne})])])])])]),n(me,null,{default:j(()=>[W.enableRowDblClick?(D(),I(L,{key:0,rows:A.value,columns:Z,infiniteScroll:F,height:"500px",onRowSelected:Q,selectableRows:g.selectableRows,selectableRowsRangeMode:g.selectableRowsRangeMode,ref_key:"grid",ref:x,onRowDblClick:te,"ajax-url":J,"ajax-request-func":T,pagination:R.value,"pagination-size":y.value},null,8,["rows","selectableRows","selectableRowsRangeMode","pagination","pagination-size"])):(D(),I(L,{key:1,rows:A.value,columns:Y,infiniteScroll:F,height:"500px",onRowSelected:Q,selectableRows:g.selectableRows,selectableRowsRangeMode:g.selectableRowsRangeMode,"ajax-url":J,"ajax-request-func":T,pagination:R.value,"pagination-size":y.value,ref_key:"grid",ref:x},null,8,["rows","selectableRows","selectableRowsRangeMode","pagination","pagination-size"]))]),_:1}),o("div",ke,[n(q,{label:"\uC120\uD0DD",onClick:ae})])]),n(pe,{modelValue:S.value,"onUpdate:modelValue":e[10]||(e[10]=t=>S.value=t)},null,8,["modelValue"])]),_:1})]),_:1},512))}},sa=he(He,[["__scopeId","data-v-d957681d"]]);export{sa as default};
