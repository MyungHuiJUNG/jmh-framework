import{Q as W}from"./QSelect.b17c746f.js";import c from"./AInput.398f059b.js";import U from"./ASelect.a02a29e0.js";import X from"./ABtn.e24d7e8a.js";import ee from"./ATitleBar.bbf1d9a4.js";import{api as T}from"./axios.816e1a60.js";import{C as te}from"./index.9642ecdd.js";import{u as oe}from"./authStore.fadf8446.js";import{u as le}from"./organizationStore.a86bd6ff.js";import{s as z,a as se}from"./dialog.88ce899f.js";import{h as B}from"./errorHandler.5efe1eb1.js";import{F as D}from"./FlowSystemCode.7be7ce49.js";import{_ as ae}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as a,y as ie,o as $,Y as ne,a as i,$ as re,z as o,c as ue,Z as de,R as M}from"./index.02f7c95d.js";import"./QItem.1bce08e7.js";import"./QMenu.3c9cf304.js";import"./position-engine.53490cc8.js";import"./rtl.276c3f1b.js";import"./format.2cae61da.js";/* empty css                                                             */import"./ClosePopup.daa62b28.js";import"./_commonjsHelpers.c10bf6cb.js";import"./_commonjs-dynamic-modules.30ae7933.js";import"./header.10137493.js";import"./CommonPopup.2b0ee10b.js";import"./use-dialog-plugin-component.234e0905.js";import"./counsel-hub.145170b4.js";const ce=x=>T.get(`/rest/api/v1/user/users/${x}`,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"date-format":"yyyy-MM-dd HH:mm:ss"}}),me=(x,y)=>T.put(`/rest/api/v1/user/users/${x}`,y,{headers:{Authorization:`Bearer ${localStorage.getItem("accessToken")}`,"date-format":"yyyy-MM-dd HH:mm:ss"}}),H={getUser:ce,putUser:me};const ve={class:"detail column"},fe={class:"col q-pa-xs b-border column table-container"},pe={class:"col-auto row fixed-height"},xe={class:"col top-border-right justify-center column q-px-xs"},ye={class:"col-auto row fixed-height"},ge={class:"col body-border-right justify-center column q-px-xs"},be={class:"col-auto row fixed-height"},he={class:"col column body-border-right justify-center q-px-xs"},we={class:"col-auto row fixed-height"},Ve={class:"col body-border-right justify-center column q-px-xs"},_e={class:"col-auto row"},qe={class:"col body-border-right justify-center column q-pa-xs"},Ue={class:"col-auto row fixed-height"},je={class:"col body-border-right justify-center column q-px-xs"},Ie={class:"col row"},Se={class:"col body-border-right justify-center q-px-xs"},Ce={class:"full-height column no-wrap text-no-wrap full-width items-center overflow-auto"},ze={class:"col-auto row fixed-height"},Ae={class:"col body-border-right justify-center column q-px-xs"},Oe={class:"col-auto row fixed-height"},Ee={class:"col body-border-right justify-center column q-px-xs"},ke={class:"col-auto row"},Ne={class:"col body-border-right justify-center column q-pa-xs"},Be={class:"col-auto text-right q-pt-xs"},De={__name:"UserProfile",setup(x){const y=D.USE_CD.USE,G=D.USE_CD.UNUSE;let F="\uC0AC\uC6A9\uC790 \uC0C1\uC138\uC815\uBCF4";const A=oe(),O=le(),j=a(""),g=a(""),m=a(""),b=a(""),L=[{label:"\uC0AC\uC6A9",value:y},{label:"\uBBF8\uC0AC\uC6A9",value:G}],I=a(y),v=a(""),h=a(""),w=a(""),V=a(""),_=a("");a("");const P=a(["\uC120\uD0DD"]),E=a(["\uC120\uD0DD"]),q=a(["\uC120\uD0DD"]),u=a("\uC120\uD0DD"),d=a("\uC120\uD0DD"),r=a("\uC120\uD0DD"),f=a([]);function k(){H.getUser(A.entityId).then(t=>{if(t.status===200){if(j.value=t.data.id,g.value=t.data.name,t.data.organization&&t.data.organization.path){const e=t.data.organization.path.split(".");Y(e)}else S();t.data.roleGroup?(v.value=t.data.roleGroup.name,_.value=t.data.roleGroup.entityId):(v.value=null,_.value=null),w.value=t.data.ctiLoginId,h.value=t.data.email,V.value=t.data.ctiExtension}}).catch(t=>{B(t)})}function S(){u.value="\uC120\uD0DD",d.value="\uC120\uD0DD",r.value="\uC120\uD0DD",E.value=["\uC120\uD0DD"],q.value=["\uC120\uD0DD"]}function Z(t){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,16}$/.test(t)}function Q(){return m.value===b.value}async function J(){if(!Z(m.value)){z("\uC601\uBB38\uACFC \uC22B\uC790\uB97C \uC870\uD569\uD558\uC5EC 8~16 \uC790\uB9AC\uB85C \uC124\uC815\uD558\uC138\uC694.");return}if(!Q()){z("\uBE44\uBC00\uBC88\uD638\uAC00 \uC77C\uCE58\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.");return}if(await se("\uC218\uC815 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){const e=K(),l={entity:{name:g.value,password:te.SHA256(m.value).toString(),email:h.value,useTypeCode:I.value,ctiLoginId:w.value,ctiExtension:V.value,..._.value&&{roleGroup:{entityId:_.value}},...e&&{organization:{entityId:e}}}};H.putUser(A.entityId,l).then(s=>{s.status===200&&(k(),z("\uC218\uC815 \uB418\uC5C8\uC2B5\uB2C8\uB2E4."),m.value="",b.value="")}).catch(s=>{B(s)})}}async function R(){f.value=Array.from(O.organizations.values()),P.value=["\uC120\uD0DD",...f.value.filter(t=>t.parentEntityId===null).map(t=>t.name)]}async function Y(t){try{if(t[0]){const e=t[0];u.value=C(e),await N(1,e),await M()}if(t[1]){const e=t[1];d.value=C(e),await N(2,e),await M()}if(t[2]){const e=t[2];r.value=C(e)}}catch{S()}}function C(t){const e=O.organizations.get(t);return e?e.name:"\uC120\uD0DD"}async function N(t){return new Promise(e=>{var l;if(t===1){const s=f.value.find(n=>n.name===u.value);s&&s.children?(E.value=["\uC120\uD0DD",...s.children.map(n=>n.name)],d.value="\uC120\uD0DD",q.value=["\uC120\uD0DD"],r.value="\uC120\uD0DD"):S()}else if(t===2){const s=f.value.find(p=>p.name===u.value),n=(l=s==null?void 0:s.children)==null?void 0:l.find(p=>p.name===d.value);n&&n.children?(q.value=["\uC120\uD0DD",...n.children.map(p=>p.name)],r.value="\uC120\uD0DD"):(q.value=["\uC120\uD0DD"],r.value="\uC120\uD0DD")}e()})}function K(){var e,l;let t=null;if(u.value!=="\uC120\uD0DD"&&(t=f.value.find(s=>s.name===u.value)),t&&d.value!=="\uC120\uD0DD"){const s=(e=t.children)==null?void 0:e.find(n=>n.name===d.value);if(s)t=s;else return t?t.entityId:null}if(t&&r.value!=="\uC120\uD0DD"){const s=(l=t.children)==null?void 0:l.find(n=>n.name===r.value);if(s)t=s;else return t?t.entityId:null}return t?t.entityId:null}return ie(()=>{k(),R()}),(t,e)=>($(),ne("div",ve,[i(ee,{title:re(F),class:"col-auto"},null,8,["title"]),o("div",fe,[o("div",pe,[e[11]||(e[11]=o("div",{class:"col-auto t-column text-left top-border-left justify-center column q-px-xs"},[o("div",null,"\uC544\uC774\uB514")],-1)),o("div",xe,[i(c,{modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=l=>j.value=l),disable:""},null,8,["modelValue"])])]),o("div",ye,[e[12]||(e[12]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},[o("div",null,"\uBE44\uBC00\uBC88\uD638")],-1)),o("div",ge,[i(c,{type:"password",modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l)},null,8,["modelValue"])])]),o("div",be,[e[13]||(e[13]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},[o("div",null,"\uBE44\uBC00\uBC88\uD638 \uD655\uC778")],-1)),o("div",he,[i(c,{type:"password",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l)},null,8,["modelValue"])])]),o("div",we,[e[14]||(e[14]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},[o("div",null,"\uC0AC\uC6A9\uC790\uBA85")],-1)),o("div",Ve,[i(c,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=l=>g.value=l),disable:""},null,8,["modelValue"])])]),o("div",_e,[e[15]||(e[15]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs text-center"}," \uC870\uC9C1(\uBD80\uC11C) ",-1)),o("div",qe,[i(U,{class:"text-no-wrap q-pb-xs",modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=l=>u.value=l),disable:""},null,8,["modelValue"]),i(U,{class:"text-no-wrap q-pb-xs",modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=l=>d.value=l),disable:""},null,8,["modelValue"]),i(U,{class:"text-no-wrap",modelValue:r.value,"onUpdate:modelValue":e[6]||(e[6]=l=>r.value=l),disable:""},null,8,["modelValue"])])]),o("div",Ue,[e[16]||(e[16]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},[o("div",null,"\uC0AC\uC6A9\uC5EC\uBD80")],-1)),o("div",je,[i(U,{modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=l=>I.value=l),options:L,disable:""},null,8,["modelValue"])])]),o("div",Ie,[e[17]||(e[17]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},"\uAD8C\uD55C\uBA85",-1)),o("div",Se,[o("div",Ce,[v.value&&v.value!==""?($(),ue(W,{key:0,class:"chip q-ma-xs",color:"primary",label:v.value,"text-color":"white",size:"md",style:{width:"80%"},clickable:"",disable:""},null,8,["label"])):de("",!0)])])]),o("div",ze,[e[18]||(e[18]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},"\uC774\uBA54\uC77C",-1)),o("div",Ae,[i(c,{modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=l=>h.value=l),disable:""},null,8,["modelValue"])])]),o("div",Oe,[e[19]||(e[19]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},"CTI ID",-1)),o("div",Ee,[i(c,{modelValue:w.value,"onUpdate:modelValue":e[9]||(e[9]=l=>w.value=l),disable:""},null,8,["modelValue"])])]),o("div",ke,[e[20]||(e[20]=o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},"\uB0B4\uC120\uBC88\uD638",-1)),o("div",Ne,[i(c,{modelValue:V.value,"onUpdate:modelValue":e[10]||(e[10]=l=>V.value=l),disable:""},null,8,["modelValue"])])]),e[21]||(e[21]=o("div",{class:"col-auto row fixed-height"},[o("div",{class:"col-auto t-column text-left body-border-left justify-center column q-px-xs"},"\uBCF4\uC720\uC2A4\uD0AC"),o("div",{class:"col body-border-right justify-center column q-px-xs"})],-1)),o("div",Be,[i(X,{label:"\uC800\uC7A5",onClick:J})])])]))}},ct=ae(De,[["__scopeId","data-v-b0e56dd6"]]);export{ct as default};
