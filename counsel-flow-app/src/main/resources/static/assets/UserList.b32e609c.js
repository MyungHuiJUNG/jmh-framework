import{g as _,r as a,t as k,o as d,Y as q,a as c,$ as M,z as s,B as $,c as y,Z as v}from"./index.02f7c95d.js";import F from"./AInput.398f059b.js";import m from"./ABtn.e24d7e8a.js";import H from"./ATitleBar.bbf1d9a4.js";import j from"./TabulatorGrid.9c80b09d.js";import{p as w}from"./permissionApi.ffe0b82d.js";import{u as K,a as Q}from"./permissionStore.29c18612.js";import{u as T}from"./use-quasar.2d4ce40a.js";import Y from"./UserPopup.4dc2e487.js";import Z from"./ACheckbox.923db872.js";import{s as f,a as G}from"./dialog.88ce899f.js";import{h as g}from"./errorHandler.5efe1eb1.js";import{F as I}from"./FlowRoleCode.12cdb02e.js";import{_ as J}from"./_plugin-vue_export-helper.cdc0426e.js";/* empty css                                                             */import"./ClosePopup.daa62b28.js";import"./axios.816e1a60.js";import"./ASelect.a02a29e0.js";import"./QItem.1bce08e7.js";import"./QSelect.b17c746f.js";import"./QMenu.3c9cf304.js";import"./position-engine.53490cc8.js";import"./rtl.276c3f1b.js";import"./format.2cae61da.js";import"./use-dialog-plugin-component.234e0905.js";import"./organizationStore.a86bd6ff.js";import"./header.10137493.js";import"./userApi.abe7b8c8.js";import"./ALoadingSpinner.ca275fb8.js";import"./CommonPopup.2b0ee10b.js";import"./authStore.fadf8446.js";import"./counsel-hub.145170b4.js";const W={class:"fit column"},X={class:"my-table full-width a-border col-auto q-mb-xs"},ee={class:"a-border"},te={class:"row"},oe={class:"row q-gutter-xs justify-end"},se={class:"row full-width justify-end q-pa-xs q-gutter-xs bg-grey-5 a-border col-auto"},ie={__name:"UserList",setup(le){const A=T(),p=K(),E=_(()=>p.hasPermission(I.PERMISSION_ROLE.DELETE)),B=_(()=>p.hasPermission(I.PERMISSION_ROLE.SAVE)),R=_(()=>p.hasPermission(I.PERMISSION_ROLE.ADD));function C(){if(i.entityId==null){f("\uC120\uD0DD\uB41C \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}return new Promise(e=>{A.dialog({component:Y,componentProps:{selectableRows:!0,selectableRowsRangeMode:"click"}}).onOk(o=>{o.payload.forEach(t=>{u.value.some(O=>O.entityId===t.entityId)||u.value.push({entityId:t.entityId,name:t.name,id:t.id})})}).onCancel(()=>{e(null)})})}const i=Q();let z="\uC0AC\uC6A9\uC790 \uBAA9\uB85D";const h=a(null),l=a(""),r=a(!1),V=[{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerHozAlign:"center",headerSort:!1,width:20},{title:"#",field:"rownum",formatter:"rownum",headerHozAlign:"center",hozAlign:"center",headerSort:!1,resizable:!1,width:50},{title:"\uC0AC\uC6A9\uC790\uBA85",field:"name",hozAlign:"center",headerHozAlign:"center",headerSort:!0},{title:"\uC544\uC774\uB514",field:"id",hozAlign:"center",headerHozAlign:"center",headerSort:!0}],u=a([]);function x(){const e=h.value.getData();if(e.length>0){const o={entities:[]};e.forEach(t=>{o.entities.push({entityId:t.entityId})}),w.postUsersByPermission(o,i.entityId).then(t=>{t.status===200&&f("\uC800\uC7A5 \uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}).catch(t=>{g(t)})}}function S(){i.entityId?w.getUsersByPermission(i.entityId).then(e=>{e.status===200&&(u.value=e.data)}).catch(e=>{g(e)}):u.value=[]}const U=a([]);async function N(){if(i.entityId==null){f("\uC120\uD0DD\uB41C \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}const e=h.value.getSelectedData();if(e.length===0){f("\uC120\uD0DD\uB41C \uC0AC\uC6A9\uC790\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(await G("\uC0AD\uC81C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){const t=e.map(n=>n.entityId).join(",");w.deleteUsersByPermission(i.entityId,t).then(n=>{n.status===200&&S()}).catch(n=>{g(n)})}}function D(e){U.value=e}const b=a([]);function P(){const e=[];r.value&&l.value.trim()&&e.push({field:"name",type:"like",value:l.value.trim()}),b.value=e.length>0?e:[]}function L(){l.value="",r.value=!1}return k(l,e=>{e?r.value=!0:r.value=!1}),k(()=>i.entityId,()=>{S()}),(e,o)=>(d(),q("div",W,[c(H,{title:M(z),class:"col-auto full-width q-mb-xs"},null,8,["title"]),s("table",X,[s("tbody",null,[s("tr",null,[s("td",ee,[s("div",te,[c(Z,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=t=>r.value=t),label:"\uC0AC\uC6A9\uC790\uBA85"},null,8,["modelValue"])])]),s("td",null,[c(F,{modelValue:l.value,"onUpdate:modelValue":o[1]||(o[1]=t=>l.value=t),onKeyup:$(P,["enter"])},null,8,["modelValue"])]),s("td",null,[s("div",oe,[c(m,{label:"\uC870\uD68C",onClick:P}),c(m,{label:"\uCD08\uAE30\uD654",onClick:L})])])])])]),c(j,{class:"full-width col",rows:u.value,columns:V,filters:b.value,onRowSelected:D,selectableRows:!0,selectableRowsRangeMode:"click",ref_key:"childRef",ref:h},null,8,["rows","filters"]),s("div",se,[R.value?(d(),y(m,{key:0,label:"\uCD94\uAC00",onClick:C})):v("",!0),E.value?(d(),y(m,{key:1,label:"\uC0AD\uC81C",onClick:N})):v("",!0),R.value||B.value?(d(),y(m,{key:2,label:"\uC800\uC7A5",onClick:x})):v("",!0)])]))}},Oe=J(ie,[["__scopeId","data-v-80faa36e"]]);export{Oe as default};
