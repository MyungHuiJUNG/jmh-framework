import{r as o,g as F,t as te,y as ae,o as M,Y as le,z as l,a as r,B as oe,c as ne,Z as se}from"./index.02f7c95d.js";import{N as ie,n as N}from"./NoticeDetail.28d356b8.js";import{s as S,a as re}from"./dialog.88ce899f.js";import ue from"./TabulatorGrid.9c80b09d.js";import k from"./AInput.398f059b.js";import E from"./ABtn.e24d7e8a.js";import ce from"./ATitleBar.bbf1d9a4.js";import O from"./ACheckbox.923db872.js";import{u as de}from"./permissionStore.29c18612.js";import{h as b}from"./errorHandler.5efe1eb1.js";import{F as P}from"./FlowRoleCode.12cdb02e.js";import{_ as fe}from"./_plugin-vue_export-helper.cdc0426e.js";import"./QBadge.c1f4e948.js";import"./axios.816e1a60.js";import"./header.10137493.js";import"./FileUploadManage.e1cb862f.js";import"./CommonPopup.2b0ee10b.js";import"./use-dialog-plugin-component.234e0905.js";import"./utils.32a0767f.js";import"./ATextEditor.d38287bf.js";/* empty css                                                             */import"./ClosePopup.daa62b28.js";import"./permissionApi.ffe0b82d.js";import"./authStore.fadf8446.js";import"./counsel-hub.145170b4.js";const me={class:"a-border q-pa-xs column fit",style:{"min-height":"680px"}},ve={class:"col-auto full-width"},he={class:"a-table full-width"},pe={class:"t-column"},ge={class:"row"},_e={class:"t-column"},we={class:"row"},De={class:"col-6"},ye={class:"col-6 row justify-end"},Ne={class:"col row q-mt-xs full-width"},be={class:"col column full-height a-border q-pa-xs"},Ae={class:"full-width text-right bg-grey-5 a-border q-pa-xs col-auto"},Ce={class:"col-7 q-ml-xs full-height a-border q-pa-xs"},Re="/rest/api/v1/notice/notices",xe={__name:"NoticeMain",setup(ze){const I=de(),m=o(!1),p=U(new Date(new Date().setMonth(new Date().getMonth()-1))),g=U(new Date),A=o(null),v=o(p),h=o(g),u=o(null),_=o(!0),d=o(!1),B=F(()=>I.hasPermission(P.NOTICE_ROLE.READ)),$=F(()=>I.hasPermission(P.NOTICE_ROLE.DELETE)),x=o(null),s=o([]),C=o([]),j=[{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerHozAlign:"center",headerSort:!1,width:20},{title:"#",formatter:"rownum",hozAlign:"center",headerHozAlign:"center",headerSort:!1,width:30},{title:"\uC81C\uBAA9",field:"title",hozAlign:"left",headerHozAlign:"center",headerSort:!0},{title:"\uB4F1\uB85D\uC790",field:"createdBy",formatter:function(t){let e=t.getData();return e.createdByUserName&&e.createdByUserId?e.createdByUserName+` [${e.createdByUserId}]`:null},hozAlign:"center",headerHozAlign:"center",headerSort:!0,width:125},{title:"\uB4F1\uB85D\uC77C\uC790",field:"createdDate",hozAlign:"center",headerHozAlign:"center",headerSort:!0,width:125}],c=o(0),w=o(100),z=o(!1),n=o({page:c.value,size:w.value,fromCreatedDate:p,toCreatedDate:D(g)});te(u,t=>{t?d.value=!0:d.value=!1}),ae(()=>{R()});function U(t){const e=new Date(t);let a=""+(e.getMonth()+1),i=""+e.getDate();const y=e.getFullYear();return a.length<2&&(a="0"+a),i.length<2&&(i="0"+i),[y,a,i].join("-")}function T(t){N.getNotices(t).then(e=>{C.value=e.data.content,z.value=e.data.last,c.value+=1}).catch(e=>{b(e)})}function R(){if(!B.value){S("\uACF5\uC9C0\uC0AC\uD56D \uC77D\uAE30 \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}m.value?n.value={fromCreatedDate:p,toCreatedDate:D(g)}:(c.value=0,n.value={page:c.value,size:w.value,fromCreatedDate:p,toCreatedDate:D(g)},T(n.value))}async function L(){if(s.value.length===0)return await S("\uC0AD\uC81C\uD560 \uBAA9\uB85D\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694."),!1;if(!await re("\uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")||!s.value[0])return!1;if(s.value.length===1)H(s.value[0].entityId);else{let e="";for(const[a,i]of s.value.entries())e+=i.entityId,a<s.value.length-1&&(e+=",");K(e)}}function H(t){N.deleteNotice(t).then(e=>{R(),A.value.resetInfo(),m.value&&V()}).catch(e=>{b(e)})}function K(t){N.deleteNotices(t).then(e=>{R(),A.value.resetInfo(),m.value&&V()}).catch(e=>{b(e)})}function Y(){v.value=p,h.value=g,u.value=null,_.value=!0,d.value=!1}function q(){if(!B.value){S("\uACF5\uC9C0\uC0AC\uD56D \uC77D\uAE30 \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}const t={};m.value?(_.value&&(t.fromCreatedDate=v.value,t.toCreatedDate=D(h.value)),d.value&&u.value.trim()&&(t.keyword=u.value.trim()),n.value={...t},V()):(_.value&&(t.fromCreatedDate=v.value,t.toCreatedDate=D(h.value)),d.value&&u.value.trim()&&(t.keyword=u.value.trim()),c.value=0,n.value={page:c.value,size:w.value,...t},T(n.value))}async function G(){if(!m.value&&!z.value){n.value={...n.value,page:c.value};try{const t=await N.getNotices(n.value);t.status===200&&(C.value=[...C.value,...t.data.content],z.value=t.data.last,c.value+=1)}catch(t){b(t)}}}function D(t){const e=new Date(t);e.setDate(e.getDate()+1);const a=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),y=String(e.getDate()).padStart(2,"0");return`${a}-${i}-${y}`}function Z(t){A.value.getNotice(t.entityId)}function J(t){s.value=[],s.value=t}function Q(t){s.value=[],s.value=t}function W(){s.value=[],x.value.deselectAllRows()}function V(){x.value.setData()}function X(t,e,a){return n.value={...n.value,page:a.page-1,size:a.size||w.value,isPaging:!0},new Promise(function(i,y){N.getNotices(n.value).then(f=>{if(f.status===200){const ee={data:f.data.content,last_page:f.data.totalPages,last_row:f.data.totalElements};i(ee)}}).catch(f=>{b(f),y(f)})})}return(t,e)=>(M(),le("div",me,[l("div",ve,[l("table",he,[l("tbody",null,[l("tr",null,[l("td",pe,[r(O,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=a=>_.value=a),label:"\uB4F1\uB85D\uC77C\uC790"},null,8,["modelValue"])]),l("td",null,[l("div",ge,[r(k,{class:"col",type:"date",modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=a=>v.value=a),max:h.value},null,8,["modelValue","max"]),r(k,{class:"col",type:"date",modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=a=>h.value=a),min:v.value},null,8,["modelValue","min"])])]),l("td",_e,[r(O,{modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=a=>d.value=a),label:"\uC81C\uBAA9 + \uB0B4\uC6A9"},null,8,["modelValue"])]),l("td",null,[l("div",we,[l("div",De,[r(k,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),onKeyup:oe(q,["enter"])},null,8,["modelValue"])]),l("div",ye,[r(E,{label:"\uC870\uD68C",onClick:q}),r(E,{label:"\uCD08\uAE30\uD654",class:"q-ml-xs",onClick:Y})])])])])])])]),l("div",Ne,[l("div",be,[r(ce,{title:"\uACF5\uC9C0\uC0AC\uD56D \uBAA9\uB85D",class:"col-auto full-width q-mb-xs"}),r(ue,{ref_key:"grid",ref:x,rows:C.value,columns:j,selectableRows:!0,"infinite-scroll":G,selectableRowsRangeMode:"click",onRowClick:Z,onRowSelected:J,onRowDeselected:Q,"ajax-url":Re,"ajax-request-func":X,pagination:m.value,"pagination-size":w.value,class:"col full-width"},null,8,["rows","pagination","pagination-size"]),l("div",Ae,[$.value?(M(),ne(E,{key:0,label:"\uC0AD\uC81C",onClick:L})):se("",!0)])]),l("div",Ce,[r(ie,{ref_key:"noticeDetail",ref:A,onRefreshNotice:R,onRefreshTabulatorRow:W},null,512)])])]))}},et=fe(xe,[["__scopeId","data-v-144bda7c"]]);export{et as default};
