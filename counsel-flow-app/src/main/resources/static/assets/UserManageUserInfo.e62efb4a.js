import q from"./TabulatorGrid.9c80b09d.js";import M from"./ABtn.e24d7e8a.js";import{u as d}from"./userApi.abe7b8c8.js";import{u as O}from"./organizationStore.a86bd6ff.js";import{u as T}from"./permissionStore.29c18612.js";import{s as C}from"./dialog.88ce899f.js";import{h as m}from"./errorHandler.5efe1eb1.js";import $ from"./ATitleBar.bbf1d9a4.js";import{F as R}from"./FlowRoleCode.12cdb02e.js";import G from"./ALoadingSpinner.ca275fb8.js";import{F as Y}from"./FlowSystemCode.7be7ce49.js";import{_ as Z}from"./_plugin-vue_export-helper.cdc0426e.js";import{r,g as k,y as J,o as x,Y as K,z as y,a as h,c as Q,Z as W,ab as X}from"./index.02f7c95d.js";/* empty css                                                             */import"./axios.816e1a60.js";import"./header.10137493.js";import"./permissionApi.ffe0b82d.js";import"./CommonPopup.2b0ee10b.js";import"./use-dialog-plugin-component.234e0905.js";import"./authStore.fadf8446.js";import"./counsel-hub.145170b4.js";import"./ClosePopup.daa62b28.js";const ee={class:"column no-wrap fit"},te={class:"text-right q-pa-xs col-auto bg-grey-5"},ae="/rest/api/v1/user/users",oe={__name:"UserManageUserInfo",emits:["rowClick","newClick"],setup(ne,{expose:E,emit:V}){const N=Y.USE_CD.USE,p=O(),z=T(),s=r(!1),_=V;E({loadInitialData:S,searchUsers:B,setData:U});const w=k(()=>z.hasPermission(R.USER_ROLE.READ)),D=k(()=>z.hasPermission(R.USER_ROLE.ADD)),v=r("");function A(){}function H(){v.value.deselectAllRows(),_("newClick")}function I(t){_("rowClick",t.entityId)}const P=[{title:"#",field:"rownum",formatter:"rownum",headerHozAlign:"center",hozAlign:"center",headerSort:!1,resizable:!1,width:50},{title:"\uC870\uC9C1(\uB300)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!0,formatter:function(t){const e=t.getValue();return e&&e.path&&e.path.split(".")[0]?p.organizations.get(e.path.split(".")[0]||"").name:""}},{title:"\uC870\uC9C1(\uC911)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!0,formatter:function(t){const e=t.getValue();return e&&e.path&&e.path.split(".")[1]?p.organizations.get(e.path.split(".")[1]||"").name:""}},{title:"\uC870\uC9C1(\uC18C)",field:"organization",hozAlign:"center",headerHozAlign:"center",headerSort:!0,formatter:function(t){const e=t.getValue();return e&&e.path&&e.path.split(".")[2]?p.organizations.get(e.path.split(".")[2]||"").name:""}},{title:"\uC0AC\uC6A9\uC790\uBA85",field:"name",hozAlign:"center",headerHozAlign:"center",headerSort:!0},{title:"\uC544\uC774\uB514",field:"id",hozAlign:"center",headerHozAlign:"center",headerSort:!0},{title:"\uC0AC\uC6A9\uC5EC\uBD80",field:"useTypeCode",hozAlign:"center",headerHozAlign:"center",headerSort:!0,formatter:function(t){const e=t.getValue();return(e&&e.value?e.value:e)===N?"\uC0AC\uC6A9":"\uC0AC\uC6A9 \uC548\uD568"}},{title:"CTI ID",field:"ctiLoginId",hozAlign:"center",headerHozAlign:"center",headerSort:!0},{title:"\uB0B4\uC120\uBC88\uD638",field:"ctiExtension",hozAlign:"center",headerHozAlign:"center",headerSort:!0}],u=r([]),o=r(0),c=r(100),f=r(!1),l=r(!1),a=r({page:o.value,size:c.value});async function b(){if(!s.value&&!f.value){a.value={...a.value,page:o.value};try{const t=await d.getUsers(a.value);t.status===200&&(u.value=[...u.value,...t.data.content],f.value=t.data.last,o.value+=1)}catch(t){m(t)}}}function B(t){if(!w.value){C("\uC0AC\uC6A9\uC790 \uC870\uD68C \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(s.value)a.value={...t},U();else return o.value=0,a.value={page:o.value,size:c.value,...t},l.value=!0,d.getUsers(a.value).then(e=>{e&&e.data&&(u.value=e.data.content,f.value=e.data.last,o.value+=1)}).catch(e=>{m(e)}).finally(()=>{l.value=!1})}function S(){if(!w.value){C("\uC0AC\uC6A9\uC790 \uC870\uD68C \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}s.value?a.value={}:(o.value=0,a.value={page:o.value,size:c.value},l.value=!0,d.getUsers(a.value).then(t=>{t.status===200&&(u.value=t.data.content,f.value=t.data.last,o.value+=1)}).catch(t=>{m(t)}).finally(()=>{l.value=!1}))}J(()=>{S()});function U(){s.value&&v.value.setData()}function F(t,e,n){return a.value={...a.value,page:n.page-1,size:n.size||c.value,isPaging:!0},new Promise(function(g,L){d.getUsers(a.value).then(i=>{if(i.status===200){const j={data:i.data.content,last_page:i.data.totalPages,last_row:i.data.totalElements};g(j)}}).catch(i=>{m(i),L(i)})})}return(t,e)=>(x(),K(X,null,[y("div",ee,[h($,{title:"\uC0AC\uC6A9\uC790\uC815\uBCF4",class:"col-auto full-width q-mb-xs"}),h(q,{rows:u.value,columns:P,onRowClick:I,onRowSelected:A,onRowDeselected:A,infiniteScroll:b,selectableRows:1,"ajax-url":ae,"ajax-request-func":F,pagination:s.value,"pagination-size":c.value,class:"col full-width",ref_key:"grid",ref:v},null,8,["rows","pagination","pagination-size"]),y("div",te,[D.value?(x(),Q(M,{key:0,label:"\uC2E0\uADDC",onClick:H})):W("",!0)])]),h(G,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=n=>l.value=n)},null,8,["modelValue"])],64))}},xe=Z(oe,[["__scopeId","data-v-39405d56"]]);export{xe as default};
