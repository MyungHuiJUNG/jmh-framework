import{a as Q,Q as z}from"./QTabPanels.3ec79e61.js";import{u as W}from"./use-quasar.2d4ce40a.js";import X from"./ATab.766fc7d1.js";import Y from"./ATabs.2a11bd5d.js";import j from"./TicketLogPanel.f99866ed.js";import F from"./NewTicket.788a9e21.js";import S from"./ATitleBar.bbf1d9a4.js";import{X as G,r as u,y as H,t as J,o as K,Y as Z,z as l,a as i,$ as ee,w as v}from"./index.02f7c95d.js";/* empty css                                                             */import{_ as te}from"./_plugin-vue_export-helper.cdc0426e.js";import{t as V}from"./ticketApi.d3774daa.js";import{t as oe}from"./ticketChannelApi.1f3fe83b.js";import{u as ae}from"./codeStore.e69f9e04.js";import{u as le}from"./counselTypeStore.5faa86f9.js";import{C as se,p as ne,a as ie,b as ce,L as ue,c as de,d as me,P as pe,e as re}from"./index.9fc4a15c.js";import"./touch.9135741d.js";import"./position-engine.53490cc8.js";import"./QBadge.c1f4e948.js";import"./QResizeObserver.dd2c8de3.js";import"./rtl.276c3f1b.js";import"./TabulatorGrid.9c80b09d.js";import"./errorHandler.5efe1eb1.js";import"./dialog.88ce899f.js";import"./CommonPopup.2b0ee10b.js";import"./use-dialog-plugin-component.234e0905.js";import"./authStore.fadf8446.js";import"./axios.816e1a60.js";import"./header.10137493.js";import"./counsel-hub.145170b4.js";import"./QTooltip.86ca1c0e.js";import"./QItem.1bce08e7.js";import"./QList.4c243fc6.js";import"./QMenu.3c9cf304.js";import"./lodash.33ed51ec.js";import"./_commonjsHelpers.c10bf6cb.js";import"./ABtn.e24d7e8a.js";import"./ASelect.a02a29e0.js";import"./QSelect.b17c746f.js";import"./format.2cae61da.js";import"./AInput.398f059b.js";import"./UserPopup.4dc2e487.js";import"./ACheckbox.923db872.js";import"./organizationStore.a86bd6ff.js";import"./userApi.abe7b8c8.js";import"./ALoadingSpinner.ca275fb8.js";import"./ClosePopup.daa62b28.js";import"./ATextarea.94103f28.js";/* empty css                                                                  */import"./FlowSystemCode.7be7ce49.js";import"./commandStore.9ed00edb.js";import"./scriptApi.ab757ee5.js";const fe={class:"row no-wrap fit",style:{"min-height":"680px"}},ge={class:"col full-height column no-wrap"},Ce={class:"row col-auto q-mb-xs a-border q-pa-xs full-width",style:{height:"247px"}},he={class:"row col-4"},ye={class:"col column"},ve={class:"col q-ml-xs column"},Te={class:"q-pa-xs a-border col q-ml-xs"},_e={class:"q-pt-xs col column no-wrap a-border full-width"},ke={__name:"CallConsult2",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const r=G(B,"modelValue");W();const g=u("ticketLog"),d=u([]),f=ae(),h=le();se.register(ne,ie,ce,ue,de,me,pe);const w=u({labels:["9/1","9/2","9/3","9/4","9/5","9/6","9/7"],datasets:[{label:"\uC778\uBC14\uC6B4\uB4DC",backgroundColor:"#3446eb",data:[140,139,110,140,139,180,234]},{label:"\uC544\uC6C3\uBC14\uC6B4\uB4DC",backgroundColor:"#f87979",data:[120,129,100,120,119,150,134]},{label:"\uD569\uACC4",backgroundColor:"#fc0362",data:[260,268,210,260,258,330,365]}]}),A=u({responsive:!0,maintainAspectRatio:!1}),T=u(null);async function q(e){var k,b,D,N,x,I,L,U,P,E;const t={typeCode:((k=f.codes.get(e.typeCode))==null?void 0:k.name)||null,entityId:e.entityId||null,statusCode:((b=f.codes.get(e.statusCode))==null?void 0:b.name)||null,inChannel:null,outChannel:null,counselCategoryCode:((D=f.codes.get(e.counselCategoryCode))==null?void 0:D.name)||null,inboundPath:e.inboundPath||null,counselTypeCodeLarge:((N=h.counselTypes.get(e.counselTypeCodeLarge))==null?void 0:N.name)||null,counselTypeCodeMedium:((x=h.counselTypes.get(e.counselTypeCodeMedium))==null?void 0:x.name)||null,counselTypeCodeSmall:((I=h.counselTypes.get(e.counselTypeCodeSmall))==null?void 0:I.name)||null,contents:e.contents||null,reservationDate:null,reservationTime:null,createdByUserName:e.createdByUserName||null,managerUserName:e.managerUserName||null,createdDate:e.createdDate||null,lastModifiedDate:e.lastModifiedDate||null,customerName:e.customerName||null,tel:e.tel||null},o="INBOUND",C="OUTBOUND";((L=e.channels)==null?void 0:L.length)&&e.channels[0].contactCode===o&&(t.inChannel=(U=f.codes.get(e.channels[0].typeCode))==null?void 0:U.name),((P=e.channels)==null?void 0:P.length)&&e.channels[0].contactCode===C&&(t.outChannel=(E=f.codes.get(e.channels[0].typeCode))==null?void 0:E.name);function s(){if(e.callbackReservationDate){const[p,M]=e.callbackReservationDate.split(" "),$=M?M.substring(0,5):"";t.reservationDate=p,t.reservationTime=$}}s(),T.value=t;const a=e.entityId,c=100*d.value.length,n=100*d.value.length;d.value.forEach(p=>{p.closed||p.focus()});const m=window.open("/view/ticketDetail",a,`width=400,height=680,left=${c},top=${n}`);m?(d.value.push(m),m.addEventListener("unload",()=>{setTimeout(()=>{m.closed&&(d.value=d.value.filter(p=>p!==m))},100)}),m.focus()):console.error("\uD31D\uC5C5\uC774 \uCC28\uB2E8\uB418\uC5C8\uAC70\uB098 \uC5F4\uB9AC\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.")}H(()=>{window.getData=()=>T.value});const y=u(null),_=u({});async function O(){const e={},t=r.value.callInfo;t.typeCode&&(e.typeCode=t.typeCode),t.statusCode&&(e.statusCode=t.statusCode),t.customerName&&(e.customerName=t.customerName),t.tel&&(e.tel=t.tel),t.inboundPath&&(e.inboundPath=t.inboundPath),t.startDate&&(e.startDate=t.startDate),t.counselTypeCodeLarge&&(e.counselTypeCodeLarge=t.counselTypeCodeLarge),t.counselTypeCodeMedium&&(e.counselTypeCodeMedium=t.counselTypeCodeMedium),t.counselTypeCodeSmall&&(e.counselTypeCodeSmall=t.counselTypeCodeSmall),t.managerEid&&(e.managerEid=t.managerEid),e.isManualCreated="N",await V.saveTicket(e).then(o=>{if(o.status===200){console.log("\uD2F0\uCF13 \uBC1C\uD589");const C=o.data.entityId,s={},a=r.value.channelInfo;s.ticketEntityId=C,a.typeCode&&(s.typeCode=a.typeCode),a.extraData&&(s.extraData=a.extraData),a.contactCode&&(s.contactCode=a.contactCode),a.startDate&&(s.startDate=a.startDate),a.key&&(s.key=a.key),oe.saveTicketChannel(s).then(c=>{c.status===200&&(console.log("\uD2F0\uCF13 \uCC44\uB110 \uBC1C\uD589"),V.getTicketByEntityId(C).then(n=>{n.status===200&&(console.log("\uD2F0\uCF13 \uC0C1\uC138\uC815\uBCF4 \uC870\uD68C"),_.value=n.data)}).catch(n=>{n.response.status===400&&n.response.data.message&&showAlert(n.response.data.message),console.log(n)}))}).catch(c=>{c.response.status===400&&c.response.data.message&&showAlert(c.response.data.message),console.log(c)})}}).catch(o=>{o.response.status===400&&o.response.data.message&&showAlert(o.response.data.message),console.log(o)})}function R(){console.log("[\uC7AC\uD638\uCD9C]"),y.value.getTickets(r.value.callInfo.tel)}return J(r,e=>{e&&O().then(()=>{y.value.getTickets(r.value.callInfo.tel)})}),(e,t)=>(K(),Z("div",fe,[l("div",ge,[l("div",Ce,[l("div",he,[l("div",ye,[i(S,{title:"\uC778\uBC14\uC6B4\uB4DC \uC0C1\uB2F4\uD604\uD669",class:"col-auto"}),t[2]||(t[2]=l("div",{class:"a-border col bound-border row flex-center"},[l("span",null,"234")],-1))]),l("div",ve,[i(S,{title:"\uC544\uC6C3\uBC14\uC6B4\uB4DC \uC0C1\uB2F4\uD604\uD669",class:"col-auto"}),t[3]||(t[3]=l("div",{class:"a-border col bound-border row flex-center"},[l("span",null,"134")],-1))])]),l("div",Te,[i(ee(re),{options:A.value,data:w.value},null,8,["options","data"])])]),l("div",_e,[i(Y,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o),class:"col-auto full-width"},{default:v(()=>[i(X,{name:"ticketLog",label:"\uD2F0\uCF13\uC774\uB825"})]),_:1},8,["modelValue"]),i(z,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=o=>g.value=o),"keep-alive":"",class:"col"},{default:v(()=>[i(Q,{name:"ticketLog",class:"q-pa-xs"},{default:v(()=>[i(j,{onRowClick:q,ref_key:"grid",ref:y},null,512)]),_:1})]),_:1},8,["modelValue"])])]),i(F,{class:"col-auto full-height","new-ticket":_.value,onUpdate:R},null,8,["new-ticket"])]))}},Tt=te(ke,[["__scopeId","data-v-2f17301e"]]);export{Tt as default};
